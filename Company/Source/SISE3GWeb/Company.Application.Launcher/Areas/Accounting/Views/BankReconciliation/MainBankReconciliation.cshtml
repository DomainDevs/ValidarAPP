@using Sistran.Core.Framework.UIF.Web.Resources

@{
    ViewBag.Title = @Global.BankConciliation;
    Layout = "~/Views/Shared/_UIFLayout-r2-BigMenu.cshtml";
}

@section Breadcrumb
{
    <ol class="breadcrumb global-header-breadcrumb">
        <li>@Global.BankConciliation</li>
        <li>@Global.BankConciliation</li>
    </ol>
}

@section Toolbar
{
    <footer>
        @if (Sistran.Core.Framework.UIF.Web.Helpers.SessionHelper.IsAuthorize("0568"))
        {
            <button id="btnCancelReconciliation" class="btn btn-default" role="button">
                <i class="fa fa-remove"></i>  @Global.Cancel
            </button>
        }
        @if (Sistran.Core.Framework.UIF.Web.Helpers.SessionHelper.IsAuthorize("0567"))
        {
            <button id="btnSaveConciliation" class="btn btn-primary" role="button">
                <i class="fa fa-save"></i>  @Global.Save
            </button>
        }


    </footer>
}

@section Modals
{
    <form id="addForm">
        <div class="uif-modal" id="modalView">
            <div class="uif-modalbody">
                @Html.Partial("~/Areas/Accounting/Views/BankReconciliation/BankReconciliationModal.cshtml")
                </div>

            <div class="uif-modalbuttons">
                <button type="button" class="btn btn-default" data-dismiss="modal">@Global.Cancel</button>
            </div>
        </div>
    </form>

    <!-- Modal confirmación de grabación -->
    <div class="modal fade" id="modalSave" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header" style="padding: 10px">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                        <i class="fa fa-times-circle">
                        </i>
                    </button>
                    <h4 class="modal-title"><label id="saveMessageTitle">@Global.MessageSaveConciliationTitle</label></h4>
                </div>
                <div class="modal-body" id="saveMessageModal">
                    <p>@Global.MessageSaveConciliationDialog</p>
                </div>
                <div class="modal-footer" style="padding: 10px 20px 10px">
                    <button type="button" class="btn btn-default" data-dismiss="modal">
                        <span class="glyphicon glyphicon-remove"></span> @Global.Cancel
                    </button>
                    <button type="button" class="btn btn-primary" id="btnSaveModal">
                        <span class="glyphicon glyphicon-ok"></span> @Global.Accept
                    </button>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
    </div><!-- /.modal -->
}

@*
<div class="uif-row">
    <div class="pull-right">
        <button id="btnSaveConciliation" class="btn btn-primary" role="button">
            <span class="glyphicon glyphicon-floppy-disk"></span>  @Global.Save
        </button>
        <button id="btnCancel" class="btn btn-default" role="button">
            <span class="glyphicon glyphicon-remove"></span>  @Global.Cancel
        </button>
    </div>
</div>
*@

<form id="formBankConciliation" onsubmit="return false" class="form">
    <div class="uif-row">
        <div class="uif-col-6">
            <label>@Global.Bank</label>
            <select class="uif-select form-control" id="selectBankReconciliation" name="selectBankReconciliation" data-val="true" data-val-required='@Global.RequiredField'
                    data-source='@Url.Content("~/Accounting/Common/GetBanks")' data-id="Id" data-name="Description" data-native="true"></select>
            <span class="text-danger" data-valmsg-for="selectBankReconciliation" data-valmsg-replace="true" />
        </div>
        <div class="uif-col-3">
            <label>@Global.DateTo</label>
            <input type="text" value="@ViewBag.CurrentDate" class="uif-datepicker" data-mask="99/99/9999" id="DateToReconciliation" name="DateToReconciliation"
                   data-val="true" data-val-required='@Global.RequiredField' />
            <span class="text-danger" data-valmsg-for="DateToReconciliation" data-valmsg-replace="true" />
        </div>
        <div class="uif-col-3">
            <label>@Global.ConciliationDate</label>
            <input type="text" value="@ViewBag.AccountingDate" class="uif-datepicker" data-mask="99/99/9999" id="ConciliationDate"
                   name="ConciliationDate" data-val="true" data-val-required='@Global.RequiredField' />
            <span class="text-danger" data-valmsg-for="ConciliationDate" data-valmsg-replace="true" />
        </div>
    </div>
</form>



<div class="uif-row">
    <div class="uif-col-6">
        <h3>@Global.SortingOptions</h3>
        <div class="uif-row">
            <div class="btn-group btn-block" data-toggle="buttons">
                <div class="uif-col-4">
                    <span class="glyphicon glyphicon-check" id="checkType"></span><input type="checkbox" id="typeCheck"> @Global.Type
                </div>
                <div class="uif-col-4">
                    <span class="glyphicon glyphicon-check" id="checkDateReconciliation"></span><input type="checkbox" id="dateCheck"> @Global.Date
                </div>
                <div class="uif-col-4">
                    <span class="glyphicon glyphicon-check" id="checkMonth"></span><input type="checkbox" id="monthCheck"> @Global.Month
                </div>
            </div>
        </div>
        <div class="uif-row">
            <div class="uif-col-4" hidden="hidden">
                <span class="glyphicon glyphicon-unchecked" id="checkBranch"></span><input type="checkbox" id="branchCheck"> @Global.Branch
            </div>
            <div class="uif-col-4">
                <span class="glyphicon glyphicon-check" id="checkVoucher"></span><input type="checkbox" id="voucherCheck"> @Global.Number
            </div>
        </div>
    </div>
    <div class="uif-col-6">
        <h3>@Global.AutomaticSelectionOptions</h3>
        <div class="uif-row">
            <div class="uif-col-4">
                <span class="glyphicon glyphicon-check" id="checkAutoType"></span><input type="checkbox" id="autoTypeCheck"> @Global.Type
            </div>
            <div class="uif-col-4">
                <span class="glyphicon glyphicon-check" id="checkAutoDate"></span><input type="checkbox" id="autoDateCheck"> @Global.Date
            </div>
            <div class="uif-col-4">
                <span class="glyphicon glyphicon-check" id="checkAutoMonth"></span><input type="checkbox" id="autoMonthCheck"> @Global.Month
            </div>
        </div>
        <div class="uif-row">
            <div class="uif-col-4" hidden="hidden">
                <span class="glyphicon glyphicon-unchecked" id="checkAutoBranch"></span><input type="checkbox" id="autoBranchCheck"> @Global.Branch
            </div>
            <div class="uif-col-4">
                <span class="glyphicon glyphicon-check" id="checkAutoVoucher"></span><input type="checkbox" id="autoVoucherCheck"> @Global.Number
            </div>
        </div>
    </div>
</div>

<div class="uif-row">
    <div class="uif-col-6">
        <h3>@Global.DataSource</h3>
        <div class="uif-row">
            <div class="uif-col-4">
                <span class="glyphicon glyphicon-check" id="checkOriginBank"></span><input type="checkbox" id="originBankCheck"> @Global.Bank (B)
            </div>
            <div class="uif-col-4">
                <span class="glyphicon glyphicon-check" id="checkOriginCAccounting"></span><input type="checkbox" id="originCAccountingCheck"> @Global.CentralAccounting (C)
            </div>
            <div class="uif-col-4">
                <span class="glyphicon glyphicon-check" id="checkOriginDAccounting"></span><input type="checkbox" id="originDAccountingCheck"> @Global.DailyAccounting (D)
            </div>
        </div>
        <div class="uif-row">
            <div class="uif-col-4">
                <div id="container">
                    <p><img src="@Url.Content("~/Images/loader.gif")" /> @Global.Processing</p>
                </div>
            </div>
            <div class="uif-col-8">
                <div class="pull-right">
                    @if (Sistran.Core.Framework.UIF.Web.Helpers.SessionHelper.IsAuthorize("0565"))
                    {
                        <button type="button" class="btn btn-primary" id="btnProcessReconciliation" onclick="return false">@Global.Process</button>
                    }

                </div>
            </div>
        </div>
    </div>
    <div class="uif-col-6">
        <h3>@Global.PartialSummary</h3>
        <div class="uif-row">
            <div class="uif-col-3">
                <label>@Global.Records:</label>
            </div>
            <div class="uif-col-3">
                <span id="record"></span>
            </div>
            <div class="uif-col-3">
                <label>@Global.Bank:</label>
            </div>
            <div class="uif-col-3">
                <span id="bankAmount"></span>
            </div>
        </div>

        <div class="uif-row">
            <div class="uif-col-3">
                <label>@Global.Source:</label>
            </div>
            <div class="uif-col-3">
                <span id="origin"></span>
            </div>
            <div class="uif-col-3">
                <label>@Global.Accounting:</label>
            </div>
            <div class="uif-col-3">
                <span id="accountingAmount"></span>
            </div>
        </div>

        <div class="uif-row">
            <div class="uif-col-3">
                <label>@Global.Type:</label>
            </div>
            <div class="uif-col-3">
                <span id="movementType"></span>
            </div>
            <div class="uif-col-3">
                <label>@Global.Difference:</label>
            </div>
            <div class="uif-col-3">
                <span id="movementDifference"></span>
            </div>
        </div>
        <div class="uif-row">
            <div class="uif-col-12">
                <div class="pull-right">
                    @if (Sistran.Core.Framework.UIF.Web.Helpers.SessionHelper.IsAuthorize("0566"))
                    {
                        <button type="button" class="btn btn-primary" id="btnReconcile" onclick="return false">@Global.Reconcile</button>
                    }

                </div>
            </div>
        </div>
    </div>
</div>
@*
    <div class="uif-row">
        <div class="uif-col-3">
            <div id="container">
                <p><img src="@Url.Content("~/Images/loader.gif")" /> @Global.Processing</p>
            </div>
        </div>
    </div>
*@
<div class="uif-row">
    <div class="uif-col-12">
        <div class="uif-alert" id="alertReconciliation"></div>
    </div>
</div>
<div class="uif-row">
    <div class="uif-col-12">
        <ul class="uif-tab" id="tabMainConciliation">
            <li class="active"><a href="#tabPending">@Global.ReconcilePending</a></li>
            <li><a href="#tabConciliation">@Global.ConciliationMovement</a></li>
        </ul>

        <div class="uif-tab-content">
            <div class="active" id="tabPending">
                <table class="uif-table" id="tablePendingReconciliation" data-exporttocsv="false" data-exportname="cultura" data-add="false" data-edit="false"
                       data-delete="false" data-filter="true" data-selectiontype="multiple" data-title="@Global.ReconcilePending">
                    <thead>
                        <tr>
                            <th data-property="MovementOrigin">@Global.Source</th>
                            <th data-property="Id" data-visible="false">Id</th>
                            <th data-property="BankId" data-visible="false">BankId</th>
                            <th data-property="MovementId" data-visible="false">MovementId</th>
                            <th data-property="BankingMovementTypeId">@Global.Code</th>
                            <th data-property="BankingMovementTypeDescription">@Global.DocumentType</th>
                            <th data-property="BranchId" data-visible="false">BranchId</th>
                            <th data-property="BranchDescription" data-visible="false">BranchDescription</th>
                            <th data-property="VoucherNumber">@Global.DocumentNumber</th>
                            <th data-property="MovementDescription">@Global.Description</th>
                            <th data-property="MovementDate">@Global.Date</th>
                            <th data-property="MovementAmount" @*data-type="currency"*@ style="text-align:right;" align="right">@Global.Amount</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
            <div id="tabConciliation">
                <table class="uif-table" id="tableConciliation" data-exporttocsv="false" data-edit="false" data-delete="false" data-selectiontype="single" data-filter="true"
                       data-paginate="true" data-title="@Global.ConciliationMovement">
                    <thead>
                        <tr>
                            <th data-property="Id">@Global.Code</th>
                            <th data-property="BankingMovementTypeDescription">@Global.DocumentType</th>
                            <th data-property="VoucherNumber">@Global.DocumentNumber</th>
                            <th data-property="MovementDate">@Global.Date</th>
                            <th data-property="MovementBankAmount" data-type="currency">@Global.Bank</th>
                            <th data-property="MovementAccountingAmount" data-type="currency">@Global.Accounting</th>
                            <th data-property="MovementDifference" data-type="currency">@Global.Difference</th>
                            <th data-property="ConciliationId" data-visible="false">ConciliationId</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
    </div>
</div>
@*VIEWBAGS*@
<input type="hidden" id="ViewBagAccountingDateBankReconcilation" value="@ViewBag.AccountingDate" />
<input type="hidden" id="ViewBagMaximumDeviation" value="@ViewBag.MaximumDeviation" />

@section scripts
{
    @Scripts.Render("~/accounting/bundles/MainBankReconciliation")
}